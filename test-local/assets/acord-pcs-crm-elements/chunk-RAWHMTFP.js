import{b as P,e as F,g as k,h as $,i as G,k as R}from"./chunk-4ZUVIGTG.js";import{a as j}from"./chunk-R3ZE6C4I.js";import{C as r,Ga as M,Ia as w,J as T,La as O,R as s,S as c,Sa as I,U as L,V as h,W as u,X as e,Y as i,Z as v,ca as x,da as m,db as B,ha as _,ia as A,ja as a,ka as g,la as p,o as D,sa as N,v as y,va as b,xa as S,za as E}from"./chunk-GXYEV7RV.js";var K=n=>["/parties",n],U=n=>["/policies",n],W=(n,d)=>d.id;function q(n,d){n&1&&(e(0,"div",34)(1,"div",37)(2,"span",38),a(3,"Loading..."),i()()())}function V(n,d){n&1&&(e(0,"div",35),v(1,"i",39),a(2," No activities found "),i())}function z(n,d){if(n&1&&(e(0,"p",47),a(1),i()),n&2){let t=m().$implicit;r(),g(t.description)}}function H(n,d){if(n&1&&(e(0,"a",49),v(1,"i",54),a(2),i()),n&2){let t=m().$implicit;u("routerLink",b(2,K,t.partyId)),r(2),p(" ",t.party.partyType==="PERSON"?t.party.firstName+" "+t.party.lastName:t.party.commercialName," ")}}function J(n,d){if(n&1&&(e(0,"a",49),v(1,"i",55),a(2),i()),n&2){let t=m().$implicit;u("routerLink",b(2,U,t.policyId)),r(2),p(" ",t.policy.policyNumber," ")}}function Q(n,d){n&1&&(e(0,"span",57),a(1,"Overdue"),i())}function X(n,d){n&1&&(e(0,"span",58),a(1,"Today"),i())}function Y(n,d){if(n&1&&(e(0,"span"),v(1,"i",56),a(2),S(3,"date"),s(4,Q,2,0,"span",57),s(5,X,2,0,"span",58),i()),n&2){let t=m().$implicit,o=m(2);_("text-danger",o.isOverdue(t))("text-warning",o.isDueToday(t)&&!o.isOverdue(t)),r(2),p(" Due: ",E(3,7,t.dueDate,"shortDate")," "),r(2),c(o.isOverdue(t)?4:-1),r(),c(o.isDueToday(t)&&!o.isOverdue(t)?5:-1)}}function Z(n,d){if(n&1&&(e(0,"div",41)(1,"div",42)(2,"div",43),v(3,"i"),i(),e(4,"div",44)(5,"div",45)(6,"div")(7,"h6",46),a(8),i(),s(9,z,2,1,"p",47),e(10,"div",48),s(11,H,3,4,"a",49),s(12,J,3,4,"a",49),s(13,Y,6,10,"span",50),i()(),e(14,"div",51)(15,"span",52),a(16),i(),e(17,"div",53),a(18),S(19,"date"),i()()()()()()),n&2){let t=d.$implicit,o=m(2);_("border-start",t.priority&&t.priority>=3),u("ngClass",o.getPriorityClass(t.priority)),r(3),A(N("bi ",o.getTypeIcon(t.activityType)," fs-4")),r(5),p(" ",t.subject||t.activityType," "),r(),c(t.description?9:-1),r(2),c(t.party?11:-1),r(),c(t.policy?12:-1),r(),c(t.dueDate?13:-1),r(2),u("ngClass",o.getStatusClass(t.activityStatus)),r(),p(" ",t.activityStatus," "),r(2),p(" ",E(19,14,t.createdAt,"short")," ")}}function tt(n,d){if(n&1&&(e(0,"div",36),L(1,Z,20,17,"div",40,W),i()),n&2){let t=m();r(),h(t.filteredActivities)}}var mt=(()=>{class n{activityService=D(B);activities=y([]);loading=y(!0);filterStatus=y("");filterType=y("");ngOnInit(){this.loadActivities()}loadActivities(){this.loading.set(!0),this.activityService.list().subscribe({next:t=>{this.activities.set(t?.items||[]),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}getTypeIcon(t){return{CALL:"bi-telephone",EMAIL:"bi-envelope",MEETING:"bi-calendar-event",TASK:"bi-check2-square",NOTE:"bi-sticky",FOLLOW_UP:"bi-arrow-repeat"}[t]||"bi-activity"}getStatusClass(t){return{PENDING:"bg-warning text-dark",IN_PROGRESS:"bg-info",COMPLETED:"bg-success",CANCELLED:"bg-secondary"}[t]||"bg-secondary"}getPriorityClass(t){return t?t>=4?"border-danger":t>=3?"border-warning":"":""}get filteredActivities(){let t=this.activities(),o=this.filterStatus(),l=this.filterType();return o&&(t=t.filter(f=>f.activityStatus===o)),l&&(t=t.filter(f=>f.activityType===l)),t}get overdueCount(){let t=new Date;return this.activities().filter(o=>o.activityStatus==="COMPLETED"||o.activityStatus==="CANCELLED"||!o.dueDate?!1:new Date(o.dueDate)<t).length}get dueTodayCount(){let t=new Date().toDateString();return this.activities().filter(o=>o.activityStatus==="COMPLETED"||o.activityStatus==="CANCELLED"||!o.dueDate?!1:new Date(o.dueDate).toDateString()===t).length}get pendingCount(){return this.activities().filter(t=>t.activityStatus==="PENDING").length}isOverdue(t){return!t.dueDate||t.activityStatus==="COMPLETED"||t.activityStatus==="CANCELLED"?!1:new Date(t.dueDate)<new Date}isDueToday(t){return t.dueDate?new Date(t.dueDate).toDateString()===new Date().toDateString():!1}static \u0275fac=function(o){return new(o||n)};static \u0275cmp=T({type:n,selectors:[["app-activity-list"]],decls:73,vars:8,consts:[["title","Activities","subtitle","Manage tasks and activities"],[1,"btn","btn-primary"],[1,"bi","bi-plus-lg","me-1"],[1,"container-fluid","px-4"],[1,"row","mb-4"],[1,"col-md-3"],[1,"card","bg-danger","bg-opacity-10","border-danger"],[1,"card-body","text-center"],[1,"text-danger","mb-0"],[1,"text-muted"],[1,"card","bg-warning","bg-opacity-10","border-warning"],[1,"text-warning","mb-0"],[1,"card","bg-info","bg-opacity-10","border-info"],[1,"text-info","mb-0"],[1,"card","bg-secondary","bg-opacity-10"],[1,"mb-0"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","PENDING"],["value","IN_PROGRESS"],["value","COMPLETED"],["value","CANCELLED"],["value","CALL"],["value","EMAIL"],["value","MEETING"],["value","TASK"],["value","NOTE"],["value","FOLLOW_UP"],[1,"col-md-6","text-end"],[1,"card"],[1,"card-body","p-0"],[1,"text-center","py-5"],[1,"text-center","py-5","text-muted"],[1,"list-group","list-group-flush"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"bi","bi-inbox","fs-1","d-block","mb-2"],[1,"list-group-item","list-group-item-action",3,"border-start","ngClass"],[1,"list-group-item","list-group-item-action",3,"ngClass"],[1,"d-flex","align-items-start"],[1,"activity-icon","me-3"],[1,"flex-grow-1"],[1,"d-flex","justify-content-between","align-items-start"],[1,"mb-1"],[1,"text-muted","small","mb-1"],[1,"small"],[1,"me-3","text-decoration-none",3,"routerLink"],[3,"text-danger","text-warning"],[1,"text-end"],[1,"badge",3,"ngClass"],[1,"small","text-muted","mt-1"],[1,"bi","bi-person","me-1"],[1,"bi","bi-file-text","me-1"],[1,"bi","bi-calendar","me-1"],[1,"badge","bg-danger","ms-1"],[1,"badge","bg-warning","text-dark","ms-1"]],template:function(o,l){o&1&&(e(0,"app-navbar",0)(1,"button",1),v(2,"i",2),a(3," New Activity "),i()(),e(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"h3",8),a(10),i(),e(11,"small",9),a(12,"Overdue"),i()()()(),e(13,"div",5)(14,"div",10)(15,"div",7)(16,"h3",11),a(17),i(),e(18,"small",9),a(19,"Due Today"),i()()()(),e(20,"div",5)(21,"div",12)(22,"div",7)(23,"h3",13),a(24),i(),e(25,"small",9),a(26,"Pending"),i()()()(),e(27,"div",5)(28,"div",14)(29,"div",7)(30,"h3",15),a(31),i(),e(32,"small",9),a(33,"Total"),i()()()()(),e(34,"div",16)(35,"div",17)(36,"div",18)(37,"div",5)(38,"select",19),x("ngModelChange",function(C){return l.filterStatus.set(C)}),e(39,"option",20),a(40,"All Statuses"),i(),e(41,"option",21),a(42,"Pending"),i(),e(43,"option",22),a(44,"In Progress"),i(),e(45,"option",23),a(46,"Completed"),i(),e(47,"option",24),a(48,"Cancelled"),i()()(),e(49,"div",5)(50,"select",19),x("ngModelChange",function(C){return l.filterType.set(C)}),e(51,"option",20),a(52,"All Types"),i(),e(53,"option",25),a(54,"Call"),i(),e(55,"option",26),a(56,"Email"),i(),e(57,"option",27),a(58,"Meeting"),i(),e(59,"option",28),a(60,"Task"),i(),e(61,"option",29),a(62,"Note"),i(),e(63,"option",30),a(64,"Follow-up"),i()()(),e(65,"div",31)(66,"span",9),a(67),i()()()()(),e(68,"div",32)(69,"div",33),s(70,q,4,0,"div",34)(71,V,3,0,"div",35)(72,tt,3,0,"div",36),i()()()),o&2&&(r(10),g(l.overdueCount),r(7),g(l.dueTodayCount),r(7),g(l.pendingCount),r(7),g(l.activities().length),r(7),u("ngModel",l.filterStatus()),r(12),u("ngModel",l.filterType()),r(17),p(" ",l.filteredActivities.length," activities "),r(3),c(l.loading()?70:l.filteredActivities.length===0?71:72))},dependencies:[O,M,I,R,$,G,k,P,F,j,w],styles:[".card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.activity-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background-color:#f8f9fa;border-radius:50%;color:#6c757d}.list-group-item[_ngcontent-%COMP%]{border-left-width:3px}.list-group-item.border-danger[_ngcontent-%COMP%]{border-left-color:#dc3545}.list-group-item.border-warning[_ngcontent-%COMP%]{border-left-color:#ffc107}"]})}return n})();export{mt as ActivityListComponent};
