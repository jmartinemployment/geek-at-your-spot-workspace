import{a as W}from"./chunk-JYWANAJK.js";import{a as I,b as k,e as w,g as P,h as $,i as A,k as Q}from"./chunk-4ZUVIGTG.js";import{a as U}from"./chunk-R3ZE6C4I.js";import{Aa as M,C as r,Ga as T,J as h,Ka as D,La as _,Sa as O,U as L,V as E,W as m,X as a,Y as i,Z as p,a as f,b as C,ca as S,cb as F,da as N,ja as l,ka as c,la as b,o as y,v as d,xa as v,ya as x}from"./chunk-GXYEV7RV.js";var B=(s,u)=>u.status;function V(s,u){if(s&1&&(a(0,"div",5)(1,"div",31)(2,"div",32)(3,"span",33),l(4),i(),a(5,"h4",34),l(6),i(),a(7,"small",27),l(8),v(9,"currency"),i()()()()),s&2){let t=u.$implicit,n=N();r(3),m("ngClass",n.getStatusBadgeClass(t.status)),r(),b(" ",t.status," "),r(2),c(t.count),r(2),c(M(9,4,t.value,"USD","symbol","1.0-0"))}}var ee=(()=>{class s{leadService=y(F);leads=d([]);loading=d(!0);searchTerm=d("");filterStatus=d("");columns=[{key:"displayName",label:"Name",type:"link",linkPrefix:"/leads"},{key:"leadStatus",label:"Status",type:"badge",badgeClass:this.getStatusBadgeClass},{key:"leadSource",label:"Source"},{key:"interestedLinesDisplay",label:"Interested In"},{key:"estimatedPremium",label:"Est. Premium",type:"currency"},{key:"leadDate",label:"Lead Date",type:"date"}];ngOnInit(){this.loadLeads()}loadLeads(){this.loading.set(!0),this.leadService.list().subscribe({next:t=>{let n=t.items.map(e=>C(f({},e),{displayName:e.companyName||`${e.firstName} ${e.lastName}`,interestedLinesDisplay:e.interestedLines?.join(", ")||"\u2014"}));this.leads.set(n),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}getStatusBadgeClass(t){return{NEW:"bg-info",CONTACTED:"bg-primary",QUALIFIED:"bg-warning text-dark",QUOTED:"bg-purple",WON:"bg-success",LOST:"bg-danger"}[t]||"bg-secondary"}get filteredLeads(){let t=this.leads(),n=this.searchTerm().toLowerCase(),e=this.filterStatus();return n&&(t=t.filter(o=>o.displayName?.toLowerCase().includes(n)||o.email?.toLowerCase().includes(n))),e&&(t=t.filter(o=>o.leadStatus===e)),t}get pipelineStats(){let t={},n=["NEW","CONTACTED","QUALIFIED","QUOTED","WON"];return n.forEach(e=>{t[e]={count:0,value:0}}),this.leads().forEach(e=>{t[e.leadStatus]&&(t[e.leadStatus].count++,t[e.leadStatus].value+=e.estimatedPremium||0)}),n.map(e=>f({status:e},t[e]))}get totalPipelineValue(){return this.leads().filter(t=>t.leadStatus!=="LOST").reduce((t,n)=>t+(n.estimatedPremium||0),0)}static \u0275fac=function(n){return new(n||s)};static \u0275cmp=h({type:s,selectors:[["app-lead-list"]],decls:46,vars:9,consts:[["title","Leads","subtitle","Manage sales leads"],["routerLink","/leads/new",1,"btn","btn-primary"],[1,"bi","bi-plus-lg","me-1"],[1,"container-fluid","px-4"],[1,"row","mb-4"],[1,"col"],[1,"alert","alert-primary","d-flex","justify-content-between","align-items-center","mb-4"],[1,"bi","bi-graph-up","me-2"],[1,"fs-4","fw-bold"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-5"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Search by name or email...",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-3"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","NEW"],["value","CONTACTED"],["value","QUALIFIED"],["value","QUOTED"],["value","WON"],["value","LOST"],[1,"col-md-4","text-end"],[1,"text-muted"],[1,"card"],[1,"card-body","p-0"],["emptyMessage","No leads found",3,"columns","data","loading"],[1,"card","pipeline-card"],[1,"card-body","text-center","py-3"],[1,"badge","mb-2",3,"ngClass"],[1,"mb-0"]],template:function(n,e){n&1&&(a(0,"app-navbar",0)(1,"a",1),p(2,"i",2),l(3," New Lead "),i()(),a(4,"div",3)(5,"div",4),L(6,V,10,9,"div",5,B),i(),a(8,"div",6)(9,"span"),p(10,"i",7),a(11,"strong"),l(12,"Total Pipeline Value"),i()(),a(13,"span",8),l(14),v(15,"currency"),i()(),a(16,"div",9)(17,"div",10)(18,"div",11)(19,"div",12)(20,"div",13)(21,"span",14),p(22,"i",15),i(),a(23,"input",16),S("ngModelChange",function(g){return e.searchTerm.set(g)}),i()()(),a(24,"div",17)(25,"select",18),S("ngModelChange",function(g){return e.filterStatus.set(g)}),a(26,"option",19),l(27,"All Statuses"),i(),a(28,"option",20),l(29,"New"),i(),a(30,"option",21),l(31,"Contacted"),i(),a(32,"option",22),l(33,"Qualified"),i(),a(34,"option",23),l(35,"Quoted"),i(),a(36,"option",24),l(37,"Won"),i(),a(38,"option",25),l(39,"Lost"),i()()(),a(40,"div",26)(41,"span",27),l(42),i()()()()(),a(43,"div",28)(44,"div",29),p(45,"app-data-table",30),i()()()),n&2&&(r(6),E(e.pipelineStats),r(8),c(x(15,7,e.totalPipelineValue)),r(9),m("ngModel",e.searchTerm()),r(2),m("ngModel",e.filterStatus()),r(17),b(" ",e.filteredLeads.length," leads "),r(3),m("columns",e.columns)("data",e.filteredLeads)("loading",e.loading()))},dependencies:[_,T,O,Q,$,A,I,P,k,w,U,W,D],styles:[".card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.pipeline-card[_ngcontent-%COMP%]{transition:transform .2s}.pipeline-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.bg-purple[_ngcontent-%COMP%]{background-color:#6f42c1!important}"]})}return s})();export{ee as LeadListComponent};
