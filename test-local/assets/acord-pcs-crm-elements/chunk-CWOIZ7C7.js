import{a as O}from"./chunk-JYWANAJK.js";import{a as N,b as P,e as M,g as T,h as S,i as E,k}from"./chunk-4ZUVIGTG.js";import{a as _}from"./chunk-R3ZE6C4I.js";import{C as s,J as b,La as v,Sa as C,W as d,X as r,Y as n,Z as p,_a as A,a as g,b as u,ca as c,ja as o,la as h,o as f,v as l}from"./chunk-GXYEV7RV.js";var $=(()=>{class m{partyService=f(A);parties=l([]);loading=l(!0);searchTerm=l("");filterType=l("");columns=[{key:"displayName",label:"Name",type:"link",linkPrefix:"/parties"},{key:"partyType",label:"Type",type:"badge",badgeClass:this.getTypeBadgeClass},{key:"primaryEmail",label:"Email"},{key:"primaryPhone",label:"Phone"},{key:"primaryCity",label:"City"},{key:"createdAt",label:"Created",type:"date"}];ngOnInit(){this.loadParties()}loadParties(){this.loading.set(!0),this.partyService.list().subscribe({next:i=>{let a=i.items.map(e=>u(g({},e),{displayName:e.partyType==="PERSON"?`${e.firstName} ${e.lastName}`:e.commercialName||e.dba||"Unknown",primaryEmail:e.emails?.find(t=>t.isPrimary)?.emailAddress||e.emails?.[0]?.emailAddress||"",primaryPhone:e.phones?.find(t=>t.isPrimary)?.phoneNumber||e.phones?.[0]?.phoneNumber||"",primaryCity:e.addresses?.find(t=>t.isPrimary)?.city||e.addresses?.[0]?.city||""}));this.parties.set(a),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}getTypeBadgeClass(i){return i==="PERSON"?"bg-info":"bg-primary"}get filteredParties(){let i=this.parties(),a=this.searchTerm().toLowerCase(),e=this.filterType();return a&&(i=i.filter(t=>t.displayName?.toLowerCase().includes(a)||t.primaryEmail?.toLowerCase().includes(a))),e&&(i=i.filter(t=>t.partyType===e)),i}static \u0275fac=function(a){return new(a||m)};static \u0275cmp=b({type:m,selectors:[["app-party-list"]],decls:27,vars:6,consts:[["title","Parties","subtitle","Manage customers and organizations"],["routerLink","/parties/new",1,"btn","btn-primary"],[1,"bi","bi-plus-lg","me-1"],[1,"container-fluid","px-4"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-6"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Search by name or email...",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-3"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","PERSON"],["value","ORGANIZATION"],[1,"col-md-3","text-end"],[1,"text-muted"],[1,"card"],[1,"card-body","p-0"],["emptyMessage","No parties found",3,"columns","data","loading"]],template:function(a,e){a&1&&(r(0,"app-navbar",0)(1,"a",1),p(2,"i",2),o(3," Add Party "),n()(),r(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"span",9),p(11,"i",10),n(),r(12,"input",11),c("ngModelChange",function(y){return e.searchTerm.set(y)}),n()()(),r(13,"div",12)(14,"select",13),c("ngModelChange",function(y){return e.filterType.set(y)}),r(15,"option",14),o(16,"All Types"),n(),r(17,"option",15),o(18,"Person"),n(),r(19,"option",16),o(20,"Organization"),n()()(),r(21,"div",17)(22,"span",18),o(23),n()()()()(),r(24,"div",19)(25,"div",20),p(26,"app-data-table",21),n()()()),a&2&&(s(12),d("ngModel",e.searchTerm()),s(2),d("ngModel",e.filterType()),s(9),h(" ",e.filteredParties.length," parties "),s(3),d("columns",e.columns)("data",e.filteredParties)("loading",e.loading()))},dependencies:[v,C,k,S,E,N,T,P,M,_,O],styles:[".card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}"]})}return m})();export{$ as PartyListComponent};
